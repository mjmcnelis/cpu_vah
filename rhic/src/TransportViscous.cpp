#include <stdlib.h>
#include "../include/Macros.h"
#include "../include/EquationOfState.h"
#include "../include/TransportViscous.h"
#include "../include/Precision.h"
#include "../include/Parameters.h"

viscous_transport_coefficients::viscous_transport_coefficients(double T_in, double e_in, double p_in, int kinetic_theory_model_in)
{
	T = T_in;
	e = e_in;
	p = p_in;
	kinetic_theory_model = kinetic_theory_model_in;

	if(kinetic_theory_model != 0)	// quasiparticle model
	{
		T1  = T;
		T2  = T   * T;
		T3  = T2  * T;
		T4  = T3  * T;
		T5  = T4  * T;
		T6  = T5  * T;
		T7  = T6  * T;
		T8  = T7  * T;
		T9  = T8  * T;
		T10 = T9  * T;
		T11 = T10 * T;
		T12 = T11 * T;
		T13 = T12 * T;
		T14 = T13 * T;
		T15 = T14 * T;
		T16 = T15 * T;
		T17 = T16 * T;
		T18 = T17 * T;
		T19 = T18 * T;
		T20 = T19 * T;
		T21 = T20 * T;
		T22 = T21 * T;
	}
}


viscous_transport_coefficients::~viscous_transport_coefficients()
{

}


void viscous_transport_coefficients::compute_shear_transport_coefficients(precision etas)
{
	if(kinetic_theory_model == 0)				// small fixed m/T << 1
	{
	#ifdef PIMUNU
		taupi_inverse = T / (5. * etas);
		betapi = (e + p) / 5.;
		delta_pipi = 4./3.;
		tau_pipi = 10./7;
	#ifdef PI
		lambda_pibulkPi = 1.2;
	#endif
	#endif
	}
	else										// quasiparticle m/T
	{
	#ifdef PIMUNU
		betapi = (-199.00472581739618 + 3531.5086499845606*T1 - 26190.637140646293*T2 + 103710.80125175524*T3 - 226977.38248029075*T4 + 231111.26180499909*T5 + 33778.98696189441*T6 - 271372.2880765267*T7 + 61366.24244303631*T8 + 230687.28314441766*T9 - 46307.638411656175*T10 - 179633.2801697191*T11 + 4234.2469779172325*T12 + 120632.77649001394*T13 + 8462.919769435493*T14 - 70075.02594753174*T15 + 7058.98531537086*T16 + 37074.03548150267*T17 - 19917.974606502885*T18 - 6668.656082543784*T19 + 6631.92363360586*T20 - 2561.435049347636*T21 + 1595.658284985706*T22)/(-461.20890382363814 + 518.8899370621048*T1 + 69.63243499406956*T2 + 176.21543561309701*T3 + 426.97096279032877*T4 + 87.3232547987246*T5 - 898.7961996673047*T6 - 1148.8585940492346*T7 - 402.16541485965104*T8 + 671.1786293229865*T9 + 1278.691354404027*T10 + 964.6798065059351*T11 + 65.73603659798768*T12 - 666.4550204508824*T13 - 749.835367939212*T14 - 390.4474363739314*T15 - 70.24907516875885*T16 + 282.5529675786469*T17 + 201.85303453127952*T18 + 28.975075075658996*T19 - 2.5392537752296667*T20 + 0.111720582221376*T21 - 0.0015344807484473186*T22);

		taupi_inverse = T * betapi / ((e + p) * etas);

		delta_pipi = (290.1364770212991 - 2344.2374896737947*T1 + 7705.597405115362*T2 - 12175.058183968922*T3 + 7594.429413531012*T4 - 1763.325991489814*T5 + 14041.482894863113*T6 - 23753.270748274073*T7 - 10363.183651269264*T8 + 40485.272396799504*T9 + 7940.160522257949*T10 - 51551.101906932025*T11 - 9743.077085423502*T12 + 55133.33527602634*T13 + 15502.401708250372*T14 - 51552.20036436098*T15 - 25018.003732821147*T16 + 50232.89849131191*T17 + 40872.26771774201*T18 - 107998.10808613256*T19 + 80447.539511616*T20 - 27840.839471109335*T21 + 3856.8849054519865*T22)/(177.93397574571506 - 1236.040125960039*T1 + 2647.9157253558237*T2 + 1898.1020657025902*T3 - 18880.1467909692*T4 + 32835.631636424376*T5 - 13986.623023051017*T6 - 21369.770041580945*T7 + 15797.10677816289*T8 + 17434.314395717025*T9 - 7335.7302418985155*T10 - 18898.168567709392*T11 - 6804.814642776499*T12 + 22752.307517120906*T13 + 23816.825903146684*T14 - 31004.655800962577*T15 - 37090.379952027004*T16 + 52225.16331977536*T17 + 24335.305742409895*T18 - 79528.37254625904*T19 + 60205.230161727224*T20 - 20882.24058476642*T21 + 2891.10510273954*T22);

		tau_pipi = (145.35316880200702 + 945.8325735330569*T1 - 9432.059748907666*T2 + 22596.42779440415*T3 - 9784.043776272396*T4 - 34181.96035568426*T5 + 34197.702700924594*T6 + 30055.934244274533*T7 - 36561.874733744364*T8 - 28335.292218000726*T9 + 5977.11973697689*T10 + 71234.42447385502*T11 - 19709.508486414004*T12 - 82629.40191181841*T13 + 68245.16973379398*T14 - 25418.083938156746*T15 + 45281.46732287938*T16 - 38396.78562887629*T17 - 15722.536401858844*T18 + 35065.044789858*T19 - 14703.327275131714*T20 + 495.3046612376971*T21 + 635.0944225725251*T22)/(69.9794464389132 + 772.8645690587082*T1 - 6817.641409568438*T2 + 17584.264254853453*T3 - 15010.797317231938*T4 - 7604.751289966955*T5 + 12135.331636783556*T6 + 13007.192278996585*T7 - 6668.68065563448*T8 - 29953.01393477996*T9 + 11951.131959755548*T10 + 31191.392088457585*T11 - 8055.18103666383*T12 - 15957.418747977383*T13 - 31662.729960808883*T14 + 56472.190299920985*T15 - 12650.878253326782*T16 - 7907.762379445128*T17 - 17210.85822297314*T18 + 25963.67908353706*T19 - 10431.250099856581*T20 + 339.8973007777852*T21 + 443.0411392095061*T22);

	#ifdef PI
		lambda_pibulkPi = (9.879822491210334 + 0.8683013755063738*T1 - 412.0168092840492*T2 + 1859.8897057941656*T3 - 3386.9698076878626*T4 + 1989.5209222287162*T5 + 1196.9683409630013*T6 + 1843.4532383308515*T7 - 11669.90892798136*T8 + 13589.591202560308*T9 - 2064.5832531605697*T10 - 5129.924321205942*T11 - 1270.9597932639356*T12 + 4969.691189124399*T13 + 1476.4287689692435*T14 - 2469.6798775791253*T15 - 7366.048915431875*T16 + 13425.678258951335*T17 - 8867.023678280702*T18 + 2136.9070574729917*T19 + 425.1877672917072*T20 - 341.04228416885667*T21 + 54.09326254145119*T22)/(4.937861274931255 + 14.935238446135134*T1 - 343.85758817237814*T2 + 1504.4350271262738*T3 - 3025.9542913799596*T4 + 2671.1134258080274*T5 + 308.62701814901914*T6 - 2464.0300399859802*T7 + 1864.3341840548514*T8 - 1981.1219328572442*T9 + 2504.7735656955665*T10 + 2568.5435792825647*T11 - 9337.769790966759*T12 + 5653.562525933961*T13 + 5005.865164685112*T14 - 6141.7134596114465*T15 - 3401.1197153364037*T16 + 9251.848595994144*T17 - 6124.4610901660335*T18 + 1245.259122596452*T19 + 465.6533817587116*T20 - 287.13463604549423*T21 + 43.27396774217259*T22);
	#endif
	#endif
	}
}


void viscous_transport_coefficients::compute_bulk_transport_coefficients(precision zetas, precision third_cs2)
{
	if(kinetic_theory_model == 0)				// small fixed m/T << 1
	{
	#ifdef PI
		taubulk_inverse	= 15. * third_cs2 * third_cs2 * T / zetas;		// double check this
		betabulk = 15. * third_cs2 * third_cs2 * (e + p);
		delta_bulkPibulkPi = 2./3.;
	#ifdef PIMUNU
		lambda_bulkPipi = 1.6 * third_cs2;
	#endif
	#endif
	}
	else										// quasiparticle m/T
	{
	#ifdef PI
		betabulk = (-0.007948953078575188 + 0.14661081596073003*T1 - 1.1777625655664334*T2 + 5.361331766227172*T3 - 14.741257778197578*T4 + 22.55614429634159*T5 - 6.576476393557812*T6 - 49.09780487338844*T7 + 108.56337309035543*T8 - 92.82756914102245*T9 - 13.207303098717542*T10 + 92.66047505374776*T11 - 31.009583079365697*T12 - 94.70871405960715*T13 + 91.8841732765224*T14 + 74.70838898556993*T15 - 232.8150547126892*T16 + 243.30190088622842*T17 - 147.48937542122408*T18 + 55.643431922339644*T19 - 12.57739449695294*T20 + 1.4634338760483299*T21 - 0.05301939060818549*T22)/(10.510240872638018 - 104.28019133759065*T1 + 441.5364829337867*T2 - 1002.1908403015169*T3 + 1187.4648407987536*T4 - 356.2161423783151*T5 - 810.4503585240304*T6 + 740.6946637946174*T7 + 459.6682236004543*T8 - 814.2363727943809*T9 - 238.32114267602586*T10 + 877.6421133480828*T11 - 38.46547241779834*T12 - 1094.4806157496112*T13 + 1285.3119690734757*T14 - 769.9732410126738*T15 + 290.06949018178597*T16 - 82.27827722318108*T17 + 23.481573899105992*T18 - 6.627601521564715*T19 + 1.2475976362635588*T20 - 0.11076911862354388*T21 + 0.003828941660553107*T22);

		taubulk_inverse = T * betabulk / ((e + p) * zetas);

		delta_bulkPibulkPi = (-61.61231938958508 + 806.6821677513204*T1 - 4673.811226156834*T2 + 15236.287917055077*T3 - 29027.408534326747*T4 + 28263.742159301823*T5 - 1567.3564057188726*T6 - 22637.647081077546*T7 + 6597.76822674973*T8 + 23681.78826888058*T9 - 12138.484557927837*T10 - 19833.331819860814*T11 + 10973.194698033922*T12 + 17830.31559833379*T13 - 8926.119222102436*T14 - 16918.605763029642*T15 + 8959.17806057012*T16 + 19420.334383673337*T17 - 28189.958971142518*T18 + 16291.389808161735*T19 - 4583.2818996397455*T20 + 480.40397634992524*T21 + 16.53253610602593*T22)/(-27.477910316962866 + 180.06161425136645*T1 - 50.51956245444595*T2 - 3233.13204255847*T3 + 14440.761916675727*T4 - 29419.572729042873*T5 + 25962.73975810756*T6 + 8661.855973989968*T7 - 35065.432174092835*T8 + 3713.272572182705*T9 + 43716.26701628178*T10 - 18901.359998391614*T11 - 44956.13471353282*T12 + 29113.404048071432*T13 + 50609.25347438864*T14 - 59284.29889354307*T15 - 23738.396172313736*T16 + 85806.9132772426*T17 - 70800.84239686087*T18 + 27611.93279001703*T19 - 3948.5694518857335*T20 - 588.9749588157591*T21 + 198.24856308861118*T22);

	#ifdef PIMUNU
		lambda_bulkPipi = (165.9169457564851 - 1733.7255101736666*T1 + 8141.661368121232*T2 - 21552.520797330573*T3 + 32165.478060847825*T4 - 19604.407771507897*T5 - 13917.481148794082*T6 + 28284.235009617634*T7 - 4542.615058278952*T8 - 16626.136171010978*T9 + 8458.702146461757*T10 + 757.0687966250806*T11 - 1876.2933220036368*T12 + 18027.46983725655*T13 - 37290.035630808765*T14 + 33574.7686004331*T15 - 20505.02545193438*T16 + 17628.8331647611*T17 - 17018.27029304184*T18 + 10285.225557917576*T19 - 3205.077703340601*T20 + 365.5856994160321*T21 + 16.643673120140875*T22)/(298.763309725077 - 2116.2916420222905*T1 + 6740.778573027383*T2 - 16934.805964025552*T3 + 47858.83298949663*T4 - 112882.27822256282*T5 + 152535.73896841123*T6 - 55598.9929108521*T7 - 117031.33258443855*T8 + 117562.94685582837*T9 + 44112.68620677705*T10 - 38706.804729682306*T11 - 120403.40655041352*T12 + 55456.081432853956*T13 + 157806.49780950157*T14 - 120196.62423650328*T15 - 25098.931207320944*T16 - 115402.55172559206*T17 + 389664.73550140776*T18 - 420024.12948954443*T19 + 230958.18008319841*T20 - 66732.00430546697*T21 + 8132.911849886708*T22);
	#endif
	#endif
	}
}




/*

void viscous_transport_coefficients::compute_shear_transport_coefficients(precision etas)
{
	if(kinetic_theory_model == 0)				// small fixed m/T << 1
	{
	#ifdef PIMUNU
		taupi_inverse = T / (5. * etas);
		betapi = (e + p) / 5.;
		delta_pipi = 4./3.;
		tau_pipi = 10./7;
	#ifdef PI
		lambda_pibulkPi = 1.2;
	#endif
	#endif
	}
	else										// quasiparticle m/T
	{
	#ifdef PIMUNU
		betapi = (8.611704298094825e-6 - 0.001405354006113392*T + 0.059924402660583354*T2 - 1.1252821226321765*T3 + 11.505088678768702*T4 - 72.86243933500441*T5 +
		312.67652000568955*T6 - 919.4553300642775*T7 + 1851.880055174282*T8 - 2520.2910195876684*T9 + 2228.4719999229687*T10 -
		1163.3696941415265*T11 + 275.1649200477449*T12)/
		(4.814184219646834 - 23.427763291345297*T + 78.10907293901035*T2 - 220.9834748507111*T3 + 463.6211365026477*T4 - 658.0962754530466*T5 +
		604.0491642749903*T6 - 329.15455711633166*T7 + 83.03984882593176*T8 - 0.34262854377950497*T9 + 0.03765047242502595*T10 -
		0.0024572359354327667*T11 + 0.0000720828838022736*T12);

		taupi_inverse = T * betapi / ((e + p) * etas);

		delta_pipi = (2.3123648435463478e-14 + 2.653134872793681e-11*T - 1.0455326350305228e-9*T2 - 1.696063340536917e-7*T3 + 0.000018560221286427176*T4 -
		0.0008944307915939945*T5 + 0.02674899697420029*T6 - 0.5522877505882912*T7 + 8.267937945201288*T8 -
		91.56029564978036*T9 + 739.0326553515318*T10 - 3963.3404882266636*T11 + 9730.169228055476*T12 +
		20965.239425812917*T13 - 173092.68038544193*T14 + 441601.8355209196*T15 - 609985.9561191576*T16 +
		461827.6835107632*T17 - 114982.2164250206*T18 - 86311.83441101473*T19 + 57047.98999643514*T20)/
		(1.3980641599349208e-14 + 1.6127693285377702e-11*T - 6.144411204860252e-10*T2 - 1.051433890938483e-7*T3 + 0.000011345131910016187*T4 -
		0.0005431282800680449*T5 + 0.01615900693425236*T6 - 0.3321833715521992*T7 + 4.954699020346726*T8 - 54.642993503851*T9 +
		436.6938963652453*T10 - 2258.854846886464*T11 + 4436.04092582274*T12 + 22096.673716873258*T13 - 137668.7319149623*T14 +
		335897.8325801482*T15 - 457350.6414855325*T16 + 343974.7038645733*T17 - 84726.88495746425*T18 - 64580.14059500214*T19 +
		42303.904169419286*T20);

		tau_pipi = (3.1902902102171014e-14 + 3.6473403148287593e-11*T - 1.4681531534845377e-9*T2 - 2.2978151952475593e-7*T3 + 0.000025368864732002707*T4 -
		0.0012270677121964577*T5 + 0.03679814632697644*T6 - 0.7615536873938464*T7 + 11.424552745479811*T8 -
		126.82132531785702*T9 + 1028.7700003067368*T10 - 5604.954789297192*T11 + 14890.7521305975*T12 +
		19360.924240267435*T13 - 204925.02293835668*T14 + 537103.0759431187*T15 - 745512.8555881173*T16 +
		561278.0373283497*T17 - 132801.76145649268*T18 - 112731.1368481797*T19 + 72477.80043807805*T20)/
		(1.6126888610794705e-14 + 1.8580607657742264e-11*T - 7.129928928195451e-10*T2 - 1.2044460202699227e-7*T3 + 0.000013028426199263437*T4 -
		0.0006242124741645514*T5 + 0.01858142870918551*T6 - 0.382181612836983*T7 + 5.704001436028822*T8 -
		62.95728786337562*T9 + 503.66887793696134*T10 - 2609.353744732505*T11 + 5155.099584184365*T12 +
		25270.593371494604*T13 - 157839.53929233216*T14 + 384518.19842363964*T15 - 521522.377190076*T16 +
		388473.81248813897*T17 - 90229.75736667341*T18 - 78576.79227181048*T19 + 49825.99099452628*T20);

	#ifdef PI
		lambda_pibulkPi = (8.074008637896085e-14 + 1.4521738724610116e-10*T + 1.0561878663243956e-8*T2 - 2.886475329123721e-6*T3 + 0.00019632730980086865*T4 -
		0.006805817865750017*T5 + 0.1282156842151053*T6 - 0.7811831200642801*T7 - 25.386802662803294*T8 +
		863.2338792892917*T9 - 14260.43370444323*T10 + 152128.81589917117*T11 - 1.061580723945412e6*T12 +
		4.342640843930646e6*T13 - 7.550038649670816e6*T14 - 1.0147443792119526e6*T15 + 2.9548735254152626e7*T16 -
		6.207545065954556e7*T17 + 6.899546728673512e7*T18 - 4.33542123965421e7*T19 + 1.235521034989592e7*T20)/
		(4.0796975673978034e-14 + 7.38306951869429e-11*T + 5.536739982337452e-9*T2 - 1.4739949454496843e-6*T3 + 0.00009890464996939923*T4 -
		0.0033603924874021146*T5 + 0.06032568306522431*T6 - 0.24469257569644493*T7 - 16.386289919253468*T8 +
		499.4926315810809*T9 - 8049.062451749535*T10 + 84763.1844624573*T11 - 580218.5165589283*T12 + 2.254512842174514e6*T13 -
		3.0367484406330865e6*T14 - 4.982074081104018e6*T15 + 2.6681365580501582e7*T16 - 4.996827307344645e7*T17 +
		5.344145521716283e7*T18 - 3.285385819602032e7*T19 + 9.185346457229817e6*T20);
	#endif
	#endif
	}
}


void viscous_transport_coefficients::compute_bulk_transport_coefficients(precision zetas, precision third_cs2)
{
	if(kinetic_theory_model == 0)				// small fixed m/T << 1
	{
	#ifdef PI
		taubulk_inverse	= 15. * third_cs2 * third_cs2 * T / zetas;		// double check this
		betabulk = 15. * third_cs2 * third_cs2 * (e + p);
		delta_bulkPibulkPi = 2./3.;
	#ifdef PIMUNU
		lambda_bulkPipi = 1.6 * third_cs2;
	#endif
	#endif
	}
	else										// quasiparticle m/T
	{
	#ifdef PI
		betabulk = (0.057187918268175174 - 2.5795110808844144*T + 31.966143337661794*T2 - 186.97202223464143*T3 + 632.9739160169219*T4 -
		1356.8644912535221*T5 + 1937.6556428262882*T6 - 1901.4144609887912*T7 + 1305.7115016142484*T8 - 632.7107309491553*T9 +
		215.7883928137199*T10 - 50.783337922429304*T11 + 7.882963305898372*T12 - 0.7302386364254765*T13 +
		0.031006456705249083*T14)/
		(2168.5818494848654 - 17367.372494454743*T + 62866.89323544513*T2 - 136008.52657020878*T3 + 196076.0893015133*T4 -
		198954.9682758633*T5 + 146384.87731197142*T6 - 79310.95783243925*T7 + 31803.091369445476*T8 - 9398.242646642117*T9 +
		2016.6245278736917*T10 - 304.98512854363526*T11 + 30.758339605713708*T12 - 1.852389925261096*T13 +
		0.05027444936020055*T14);

		taubulk_inverse = T * betabulk / ((e + p) * zetas);

		delta_bulkPibulkPi = (1.955262098990002e-13 - 1.0286102187790367e-9*T + 6.53957782374812e-7*T2 + 0.00008662676108879536*T3 - 0.008921665164687816*T4 +
		0.31950076291542767*T5 - 6.066129823797041*T6 + 68.25920565155266*T7 - 468.0465644725971*T8 + 1909.401213330688*T9 -
		4215.045681169726*T10 + 3168.104197748018*T11 + 7449.660320183239*T12 - 24798.529692619188*T13 +
		34657.23217345418*T14 - 28759.299235605617*T15 + 15128.827919433375*T16 - 5066.172489658255*T17 +
		1049.0939381113071*T18 - 122.39678150759512*T19 + 6.82617964355019*T20)/
		(-1.58273592335643e-14 + 4.459265782307701e-11*T - 6.860700599531218e-8*T2 + 0.00008482961442168233*T3 - 0.006417475308485788*T4 +
		0.2123930114903609*T5 - 3.92567977244017*T6 + 44.107342577609074*T7 - 308.617580166047*T8 + 1326.532923844008*T9 -
		3337.310608286507*T10 + 4314.902473458209*T11 - 412.5262860067333*T12 - 8014.964006647219*T13 +
		13941.815759905152*T14 - 12339.957215196044*T15 + 6547.824840344025*T16 - 2129.5411398985016*T17 +
		415.83609907848324*T18 - 44.432209576757714*T19 + 2.4412911949704172*T20);


	#ifdef PIMUNU
		lambda_bulkPipi = (9.07283109760587e-13 + 1.044356089600688e-9*T + 1.8570825459205554e-8*T2 - 0.000010383747248591741*T3 + 0.0006725182074002623*T4 -
		0.021958187215747656*T5 + 0.4397556923078744*T6 - 5.868891727895856*T7 + 55.38848339983933*T8 - 387.12780497674385*T9 +
		1957.1972733740815*T10 - 6185.740163029079*T11 + 10967.838876955766*T12 - 7453.353749819169*T13 -
		8975.522847222626*T14 + 25455.37593396117*T15 - 27106.77742447009*T16 + 18163.258154641186*T17 -
		8995.775257104488*T18 + 2661.0142932905237*T19 - 94.1340107098656*T20)/
		(1.4669639567940816e-12 + 1.7120564097461783e-9*T + 3.6256018584537294e-8*T2 - 0.000017270779862929184*T3 + 0.0010862686698553277*T4 -
		0.03423463213641015*T5 + 0.6447796042110534*T6 - 7.521967258007095*T7 + 49.0085873207005*T8 - 19.491753003885083*T9 -
		3275.060944004637*T10 + 36151.77467550509*T11 - 196672.95923713865*T12 + 653352.8180727956*T13 -
		1.442644427816317e6*T14 + 2.198052464714799e6*T15 - 2.3213934123898284e6*T16 + 1.6476268842604957e6*T17 -
		719187.3926244609*T18 + 152609.79225659932*T19 - 4301.533615127118*T20);
	#endif
	#endif
	}
}

*/





