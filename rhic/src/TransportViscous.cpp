#include <stdlib.h>
#include "../include/Macros.h"
#include "../include/EquationOfState.h"
#include "../include/TransportViscous.h"
#include "../include/Precision.h"
#include "../include/Parameters.h"

viscous_transport_coefficients::viscous_transport_coefficients(double T_in, double e_in, double p_in, int kinetic_theory_model_in)
{
	T = T_in;
	e = e_in;
	p = p_in;
	kinetic_theory_model = kinetic_theory_model_in;

	if(kinetic_theory_model != 0)	// quasiparticle model
	{
		T2  = T   * T;
		T3  = T2  * T;
		T4  = T3  * T;
		T5  = T4  * T;
		T6  = T5  * T;
		T7  = T6  * T;
		T8  = T7  * T;
		T9  = T8  * T;
		T10 = T9  * T;
		T11 = T10 * T;
		T12 = T11 * T;
		T13 = T12 * T;
		T14 = T13 * T;
		T15 = T14 * T;
		T16 = T15 * T;
		T17 = T16 * T;
		T18 = T17 * T;
		T19 = T18 * T;
		T20 = T19 * T;
	}
}


viscous_transport_coefficients::~viscous_transport_coefficients()
{

}


void viscous_transport_coefficients::compute_shear_transport_coefficients(precision etas)
{
	if(kinetic_theory_model == 0)				// small fixed m/T << 1
	{
	#ifdef PIMUNU
		taupi_inverse = T / (5. * etas);
		betapi = (e + p) / 5.;
		delta_pipi = 4./3.;
		tau_pipi = 10./7;
	#ifdef PI
		lambda_pibulkPi = 1.2;
	#endif
	#endif
	}
	else										// quasiparticle m/T
	{
	#ifdef PIMUNU
		betapi = (8.611704298094825e-6 - 0.001405354006113392*T + 0.059924402660583354*T2 - 1.1252821226321765*T3 + 11.505088678768702*T4 - 72.86243933500441*T5 +
		312.67652000568955*T6 - 919.4553300642775*T7 + 1851.880055174282*T8 - 2520.2910195876684*T9 + 2228.4719999229687*T10 -
		1163.3696941415265*T11 + 275.1649200477449*T12)/
		(4.814184219646834 - 23.427763291345297*T + 78.10907293901035*T2 - 220.9834748507111*T3 + 463.6211365026477*T4 - 658.0962754530466*T5 +
		604.0491642749903*T6 - 329.15455711633166*T7 + 83.03984882593176*T8 - 0.34262854377950497*T9 + 0.03765047242502595*T10 -
		0.0024572359354327667*T11 + 0.0000720828838022736*T12);

		taupi_inverse = T * betapi / ((e + p) * etas);

		delta_pipi = (2.3123648435463478e-14 + 2.653134872793681e-11*T - 1.0455326350305228e-9*T2 - 1.696063340536917e-7*T3 + 0.000018560221286427176*T4 -
		0.0008944307915939945*T5 + 0.02674899697420029*T6 - 0.5522877505882912*T7 + 8.267937945201288*T8 -
		91.56029564978036*T9 + 739.0326553515318*T10 - 3963.3404882266636*T11 + 9730.169228055476*T12 +
		20965.239425812917*T13 - 173092.68038544193*T14 + 441601.8355209196*T15 - 609985.9561191576*T16 +
		461827.6835107632*T17 - 114982.2164250206*T18 - 86311.83441101473*T19 + 57047.98999643514*T20)/
		(1.3980641599349208e-14 + 1.6127693285377702e-11*T - 6.144411204860252e-10*T2 - 1.051433890938483e-7*T3 + 0.000011345131910016187*T4 -
		0.0005431282800680449*T5 + 0.01615900693425236*T6 - 0.3321833715521992*T7 + 4.954699020346726*T8 - 54.642993503851*T9 +
		436.6938963652453*T10 - 2258.854846886464*T11 + 4436.04092582274*T12 + 22096.673716873258*T13 - 137668.7319149623*T14 +
		335897.8325801482*T15 - 457350.6414855325*T16 + 343974.7038645733*T17 - 84726.88495746425*T18 - 64580.14059500214*T19 +
		42303.904169419286*T20);

		tau_pipi = (3.1902902102171014e-14 + 3.6473403148287593e-11*T - 1.4681531534845377e-9*T2 - 2.2978151952475593e-7*T3 + 0.000025368864732002707*T4 -
		0.0012270677121964577*T5 + 0.03679814632697644*T6 - 0.7615536873938464*T7 + 11.424552745479811*T8 -
		126.82132531785702*T9 + 1028.7700003067368*T10 - 5604.954789297192*T11 + 14890.7521305975*T12 +
		19360.924240267435*T13 - 204925.02293835668*T14 + 537103.0759431187*T15 - 745512.8555881173*T16 +
		561278.0373283497*T17 - 132801.76145649268*T18 - 112731.1368481797*T19 + 72477.80043807805*T20)/
		(1.6126888610794705e-14 + 1.8580607657742264e-11*T - 7.129928928195451e-10*T2 - 1.2044460202699227e-7*T3 + 0.000013028426199263437*T4 -
		0.0006242124741645514*T5 + 0.01858142870918551*T6 - 0.382181612836983*T7 + 5.704001436028822*T8 -
		62.95728786337562*T9 + 503.66887793696134*T10 - 2609.353744732505*T11 + 5155.099584184365*T12 +
		25270.593371494604*T13 - 157839.53929233216*T14 + 384518.19842363964*T15 - 521522.377190076*T16 +
		388473.81248813897*T17 - 90229.75736667341*T18 - 78576.79227181048*T19 + 49825.99099452628*T20);

	#ifdef PI
		lambda_pibulkPi = (8.074008637896085e-14 + 1.4521738724610116e-10*T + 1.0561878663243956e-8*T2 - 2.886475329123721e-6*T3 + 0.00019632730980086865*T4 -
		0.006805817865750017*T5 + 0.1282156842151053*T6 - 0.7811831200642801*T7 - 25.386802662803294*T8 +
		863.2338792892917*T9 - 14260.43370444323*T10 + 152128.81589917117*T11 - 1.061580723945412e6*T12 +
		4.342640843930646e6*T13 - 7.550038649670816e6*T14 - 1.0147443792119526e6*T15 + 2.9548735254152626e7*T16 -
		6.207545065954556e7*T17 + 6.899546728673512e7*T18 - 4.33542123965421e7*T19 + 1.235521034989592e7*T20)/
		(4.0796975673978034e-14 + 7.38306951869429e-11*T + 5.536739982337452e-9*T2 - 1.4739949454496843e-6*T3 + 0.00009890464996939923*T4 -
		0.0033603924874021146*T5 + 0.06032568306522431*T6 - 0.24469257569644493*T7 - 16.386289919253468*T8 +
		499.4926315810809*T9 - 8049.062451749535*T10 + 84763.1844624573*T11 - 580218.5165589283*T12 + 2.254512842174514e6*T13 -
		3.0367484406330865e6*T14 - 4.982074081104018e6*T15 + 2.6681365580501582e7*T16 - 4.996827307344645e7*T17 +
		5.344145521716283e7*T18 - 3.285385819602032e7*T19 + 9.185346457229817e6*T20);
	#endif
	#endif
	}
}


void viscous_transport_coefficients::compute_bulk_transport_coefficients(precision zetas, precision third_cs2)
{
	if(kinetic_theory_model == 0)				// small fixed m/T << 1
	{
	#ifdef PI
		taubulk_inverse	= 15. * third_cs2 * third_cs2 * T / zetas;		// double check this
		betabulk = 15. * third_cs2 * third_cs2 * (e + p);
		delta_bulkPibulkPi = 2./3.;
	#ifdef PIMUNU
		lambda_bulkPipi = 1.6 * third_cs2;
	#endif
	#endif
	}
	else										// quasiparticle m/T
	{
	#ifdef PI
		betabulk = (0.057187918268175174 - 2.5795110808844144*T + 31.966143337661794*T2 - 186.97202223464143*T3 + 632.9739160169219*T4 -
		1356.8644912535221*T5 + 1937.6556428262882*T6 - 1901.4144609887912*T7 + 1305.7115016142484*T8 - 632.7107309491553*T9 +
		215.7883928137199*T10 - 50.783337922429304*T11 + 7.882963305898372*T12 - 0.7302386364254765*T13 +
		0.031006456705249083*T14)/
		(2168.5818494848654 - 17367.372494454743*T + 62866.89323544513*T2 - 136008.52657020878*T3 + 196076.0893015133*T4 -
		198954.9682758633*T5 + 146384.87731197142*T6 - 79310.95783243925*T7 + 31803.091369445476*T8 - 9398.242646642117*T9 +
		2016.6245278736917*T10 - 304.98512854363526*T11 + 30.758339605713708*T12 - 1.852389925261096*T13 +
		0.05027444936020055*T14);

		taubulk_inverse = T * betabulk / ((e + p) * zetas);

		delta_bulkPibulkPi = (1.955262098990002e-13 - 1.0286102187790367e-9*T + 6.53957782374812e-7*T2 + 0.00008662676108879536*T3 - 0.008921665164687816*T4 +
		0.31950076291542767*T5 - 6.066129823797041*T6 + 68.25920565155266*T7 - 468.0465644725971*T8 + 1909.401213330688*T9 -
		4215.045681169726*T10 + 3168.104197748018*T11 + 7449.660320183239*T12 - 24798.529692619188*T13 +
		34657.23217345418*T14 - 28759.299235605617*T15 + 15128.827919433375*T16 - 5066.172489658255*T17 +
		1049.0939381113071*T18 - 122.39678150759512*T19 + 6.82617964355019*T20)/
		(-1.58273592335643e-14 + 4.459265782307701e-11*T - 6.860700599531218e-8*T2 + 0.00008482961442168233*T3 - 0.006417475308485788*T4 +
		0.2123930114903609*T5 - 3.92567977244017*T6 + 44.107342577609074*T7 - 308.617580166047*T8 + 1326.532923844008*T9 -
		3337.310608286507*T10 + 4314.902473458209*T11 - 412.5262860067333*T12 - 8014.964006647219*T13 +
		13941.815759905152*T14 - 12339.957215196044*T15 + 6547.824840344025*T16 - 2129.5411398985016*T17 +
		415.83609907848324*T18 - 44.432209576757714*T19 + 2.4412911949704172*T20);


	#ifdef PIMUNU
		lambda_bulkPipi = (9.07283109760587e-13 + 1.044356089600688e-9*T + 1.8570825459205554e-8*T2 - 0.000010383747248591741*T3 + 0.0006725182074002623*T4 -
		0.021958187215747656*T5 + 0.4397556923078744*T6 - 5.868891727895856*T7 + 55.38848339983933*T8 - 387.12780497674385*T9 +
		1957.1972733740815*T10 - 6185.740163029079*T11 + 10967.838876955766*T12 - 7453.353749819169*T13 -
		8975.522847222626*T14 + 25455.37593396117*T15 - 27106.77742447009*T16 + 18163.258154641186*T17 -
		8995.775257104488*T18 + 2661.0142932905237*T19 - 94.1340107098656*T20)/
		(1.4669639567940816e-12 + 1.7120564097461783e-9*T + 3.6256018584537294e-8*T2 - 0.000017270779862929184*T3 + 0.0010862686698553277*T4 -
		0.03423463213641015*T5 + 0.6447796042110534*T6 - 7.521967258007095*T7 + 49.0085873207005*T8 - 19.491753003885083*T9 -
		3275.060944004637*T10 + 36151.77467550509*T11 - 196672.95923713865*T12 + 653352.8180727956*T13 -
		1.442644427816317e6*T14 + 2.198052464714799e6*T15 - 2.3213934123898284e6*T16 + 1.6476268842604957e6*T17 -
		719187.3926244609*T18 + 152609.79225659932*T19 - 4301.533615127118*T20);
	#endif
	#endif
	}
}






